<script>
  import Info from "./_info.svelte";
  import Box from "./_box.svelte";
  import { shortenString } from "$lib/utils";

  export let service;
</script>

<style>
  .infos {
    display: flex;
    flex-direction: column;
    margin-bottom: var(--s32);
    gap: var(--s8);
  }

  .list {
    display: flex;
    flex-direction: column;
    margin-top: var(--s20);
    margin-bottom: var(--s32);
    color: var(--col-text);
    gap: var(--s8);
    list-style-position: inside;
    list-style-type: "– ";
  }

  .list li span {
    position: relative;
    left: var(--s8);
  }

  a {
    color: var(--col-magenta-cta);
    font-weight: bold;
  }
</style>

<Box title="Les modalités" --box-color="var(--col-magenta-cta)">
  <div class="infos">
    {#if service.isCumulative}
      <Info
        label="Ce service est cumulable avec d’autres dispositifs"
        positiveMood
      />
    {:else}
      <Info
        label="Ce service n’est pas cumulable avec d’autres dispositifs"
        negativeMood
      />
    {/if}

    {#if service.hasFee}
      <Info label="Frais à charge du bénéficiaire : " negativeMood>
        <p slot="details">{service.feeDetails}</p>
      </Info>
    {/if}
  </div>
  <div class="flex flex-row flex-wrap gap-2">
    <div class="flex-grow">
      <h3>Critères d’admission</h3>
      <ul class="list">
        {#each service.accessConditionsDisplay as condition}
          <li><span>{condition}</span></li>
        {:else}
          <li><span>Aucun</span></li>
        {/each}
      </ul>
    </div>
    <div class="flex-grow">
      <h3>Public concerné</h3>
      <ul class="list">
        {#each service.concernedPublicDisplay as pub}
          <li><span>{pub}</span></li>
        {:else}
          <li><span>Tout le monde</span></li>
        {/each}
      </ul>
    </div>

    <div class="flex-grow">
      <h3>Lieu de déroulement</h3>

      {#if !service.locationKinds.length}
        Non renseigné
      {:else}
        {#if service.locationKinds.includes("OS")}
          <h4 class="pt-2 pb-1">En présentiel</h4>
          <p class="pb-2 text-sm text-gray-text">
            {service.address1}<br />
            {#if service.address2}{service.address2}<br />{/if}
            {service.postalCode}
            {service.city}
          </p>
        {/if}
        {#if service.locationKinds.includes("RE")}
          <h4 class="pt-2 pb-1">À distance</h4>
          <p class="pb-2 text-sm">
            <a target="_blank" rel="noopener nofollow" href={service.remoteUrl}
              >{shortenString(service.remoteUrl, 35)}</a
            >
          </p>
        {/if}
      {/if}
    </div>
  </div>
</Box>
